<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Void in Pure Aluminum</title>
</head>

<meta http-equiv="X-UA-Compatible" content="chrome=1">
<link rel="stylesheet"
	href="http://hub.chemdoodle.com/cwc/latest/ChemDoodleWeb.css"
	type="text/css">
<script type="text/javascript"
	src="http://hub.chemdoodle.com/cwc/latest/ChemDoodleWeb.js"></script>

<script> var $=function(id){return document.getElementById(id)} </script>
<style>
td {
	padding: 5px;
}
</style>

<body>

<!-- 
D<sub>111</sub><sup>1</sup>=+x+y+z, D<sub>111</sub><sup>2</sup>=+x+y-z, D<sub>111</sub><sup>3</sup>=+x-y+z, 
D<sub>111</sub><sup>4</sup>=+x-y-z, D<sub>111</sub><sup>5</sup>=-x+y+z, D<sub>111</sub><sup>6</sup>=-x+y-z, 
D<sub>111</sub><sup>7</sup>=-x-y+z, D<sub>111</sub><sup>8</sup>=-x-y-z <br/>
D<sub>002</sub><sup>1</sup>=+x, D<sub>002</sub><sup>2</sup>=-x, D<sub>002</sub><sup>3</sup>=+y, 
D<sub>002</sub><sup>4</sup>=-y, D<sub>002</sub><sup>5</sup>=+z, D<sub>002</sub><sup>6</sup>=-z
<br/>
-->
	<table>
		<tr>
			<td>
				<table>
					<thead>
						<tr>
							<th>Distances (layers) from face to centre:</th>
						</tr>
					</thead>
					<tr>
						<td>
							<table style="font-size: 16pt; text-align: center">
								<tr>
									<td><button type="button" style="font-size: 11pt"
											onclick="setAllD(0)">Set all</button></td>
									<td>D<sub>111</sub> = <input style="width: 50px"
										type="box" id="D111_1" value="3" />
									</td>
									<td>D<sub>111&#773;</sub> = <input style="width: 50px"
										type="box" id="D111_2" value="3" />
									</td>
									<td>D<sub>11&#773;1</sub> = <input style="width: 50px"
										type="box" id="D111_3" value="3" />
									</td>
									<td>D<sub>11&#773;1&#773;</sub> = <input
										style="width: 50px" type="box" id="D111_4" value="3" />
									</td>
								</tr>
								<tr>
									<td><input style="width: 50px" type="box" id="D111_all"
										value="3"></td>
									<td>D<sub>1&#773;11</sub> = <input style="width: 50px"
										type="box" id="D111_5" value="3" />
									</td>
									<td>D<sub>1&#773;11&#773;</sub> = <input
										style="width: 50px" type="box" id="D111_6" value="3" />
									</td>
									<td>D<sub>1&#773;1&#773;1</sub> = <input
										style="width: 50px" type="box" id="D111_7" value="3" />
									</td>
									<td>D<sub>1&#773;1&#773;1&#773;</sub> = <input
										style="width: 50px" type="box" id="D111_8" value="3" />
									</td>
								</tr>
							</table>
						</td>
					</tr>
					<tr>
						<td>
							<table style="font-size: 16pt; text-align: center">
								<tr>
									<td><button type="button" style="font-size: 11pt"
											onclick="setAllD(1)">Set all</button></td>
									<td>D<sub>200</sub> = <input style="width: 50px"
										type="box" id="D002_1" value="4" />
									</td>
									<td>D<sub>020</sub> = <input style="width: 50px"
										type="box" id="D002_3" value="4" />
									</td>
									<td>D<sub>002</sub> = <input style="width: 50px"
										type="box" id="D002_5" value="4" />
									</td>
								</tr>
								<tr>
									<td><input style="width: 50px" type="box" id="D002_all"
										value="3"></td>
									<td>D<sub>2&#773;00</sub> = <input style="width: 50px"
										type="box" id="D002_2" value="4" />
									</td>
									<td>D<sub>02&#773;0</sub> = <input style="width: 50px"
										type="box" id="D002_4" value="4" />
									</td>
									<td>D<sub>002&#773;</sub> = <input style="width: 50px"
										type="box" id="D002_6" value="4" />
									</td>
								</tr>
							</table>
						</td>
					</tr>
				</table>
			</td>
			<td style="text-align: left">
				<table style="text-align: center">
					<tr>
						<td>One click<br> <input type="button" value="Generate"
							onclick="genNow()" style="font-size: 12pt; height: 47px"></td>
					</tr>
					<tr>
						<td>Or separately<br>
							<button type="button" style="font-size: 10pt" onclick="genCoor()">
								List<br>Coordinates
							</button>
							<button type="button" style="font-size: 10pt"
								onclick="loadMol('field1',Canv1)">
								Draw<br>Field 1
							</button>
							<button type="button" style="font-size: 10pt"
								onclick="loadMol('field2',Canv2)">
								Draw<br>Field 2
							</button></td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

	<table>
		<tr>
			<th>Coordinates field 1 <select id="field1_opt">
					<option value="Shape" selected="selected">Solid shape</option>
					<option value="Face">Faces only</option>
					<option value="Edge">Edges only</option>
					<option value="Vertex">Vertices</option>
			</select></th>
			<th>Coordinates field 2 <select id="field2_opt">
					<option value="Shape">Solid shape</option>
					<option value="Face">Faces only</option>
					<option value="Edge" selected="selected">Edges only</option>
					<option value="Vertex">Vertices</option>
			</select></th>
			<th>3D structure</th>
		</tr>
		<tr>
			<td><textarea id="field1"
					style="width: 350px; height: 650px; resize: none"></textarea></td>
			<td><textarea id="field2"
					style="width: 350px; height: 650px; resize: none"></textarea></td>
			<td><script>
			var Canv1=new ChemDoodle.TransformCanvas3D('Canv1-1', 300,300);
			Canv1.specs.backgroundColor='black';
			Canv1.specs.set3DRepresentation('Ball and Stick');
			Canv1.specs.projectionPerspective_3D = false;
			Canv1.loadMolecule(ChemDoodle.readXYZ(""));
			$("field1").value=""
		</script> <br> <br> <script>
			var Canv2=new ChemDoodle.TransformCanvas3D('Canv1-2', 300,300);
			Canv2.specs.backgroundColor='black';
			Canv2.specs.set3DRepresentation('Stick');
			Canv2.specs.projectionPerspective_3D = false;
			Canv2.loadMolecule(ChemDoodle.readXYZ(""));
			$("field2").value=""
		</script></td>
		</tr>
	</table>

	<script>
	var D111=[], D002=[];
	var x, y, z, bdy=[], a=4.0495;
	var nB, nS, nF, nE, nV, nOnF;
	var cdB=[], cdS=[], cdF=[], cdE=[], cdV=[]
	var onFace=[]
	var area;
	
function setAllD(p) {
	if(p==0) for(i=1;i<=8;i++) $("D111_"+i).value=$("D111_all").value
	else for(i=1;i<=6;i++) $("D002_"+i).value=$("D002_all").value
}

function genCoor() {
	D111_max=0; nB=0; nS=0; lsS=""
	cdB=[], cdS=[]
	
	for(var i=1;i<=8;i++) D111[i]=parseInt($("D111_"+i).value)
	for(var i=1;i<=6;i++) D002[i]=parseInt($("D002_"+i).value)
	
	nF=0, nE=0, nV=0, nOnF=[];
	
	bdy[1]=Math.ceil(Math.min(D111[1]+D111[4], D111[2]+D111[3], D002[1])/2)
	bdy[2]=Math.ceil(Math.min(D111[5]+D111[8], D111[6]+D111[7], D002[2])/2)
	bdy[3]=Math.ceil(Math.min(D111[1]+D111[6], D111[2]+D111[5], D002[3])/2)
	bdy[4]=Math.ceil(Math.min(D111[3]+D111[8], D111[4]+D111[7], D002[4])/2)
	bdy[5]=Math.ceil(Math.min(D111[1]+D111[7], D111[3]+D111[5], D002[5])/2)
	bdy[6]=Math.ceil(Math.min(D111[2]+D111[8], D111[4]+D111[6], D002[6])/2)

	for(x=-bdy[2]; x<=bdy[1]; x++) {
		for(y=-bdy[4]; y<=bdy[3]; y++) {
			for(z=-bdy[6]; z<=bdy[5]; z++) {
				cdB[++nB]=[    x,     y,     z]
				cdB[++nB]=[0.5+x, 0.5+y,     z]
				cdB[++nB]=[0.5+x,     y, 0.5+z]
				cdB[++nB]=[    x, 0.5+y, 0.5+z]
			}
		}
	}
	
// 	prtCoor(nB,cdB,"field1")

// 	lsS+="   "+D111[1]+"  "+D111[2]+"  "+D111[3]+"  "+D111[4]+"  "+D111[5]+"  "+D111[6]+"  "+D111[7]+"  "+
// 		D111[8]+"  "+D002[1]/2+"  "+D002[3]/2+"  "+D002[5]/2+"  "+D002[2]/2+"  "+D002[4]/2+"  "+D002[6]/2+"\n"
	for(var i=1;i<=14;i++) onFace[i]=[];
	for(var i=1; i<=nB; i++) {
		[x,y,z]=cdB[i]
		if( x+y+z<D111[1]+0.1 && -x+y+z<D111[5]+0.1 && 
			x+y-z<D111[2]+0.1 && -x+y-z<D111[6]+0.1 && 
			x-y+z<D111[3]+0.1 && -x-y+z<D111[7]+0.1 && 
			x-y-z<D111[4]+0.1 && -x-y-z<D111[8]+0.1 && 
			D002[1]/2+0.1>x   && -D002[2]/2-0.1<x   && 
			D002[3]/2+0.1>y   && -D002[4]/2-0.1<y   && 
			D002[5]/2+0.1>z   && -D002[6]/2-0.1<z) 
		{
			cdS[++nS]=[x, y, z]; nOnF[i]=0;
	// 		lsS+=i+"  "+(x+y+z)+"  "+(-x+y+z)+"  "+( x+y-z)+"  "+(-x+y-z)+"  "+(x-y+z)+"  "+(-x-y+z)+"  "+( x-y-z)+"  "
	// 			+(-x-y-z)+"  "+x+"  "+(y)+"  "+(z)+"  "+nOnF[i]+"\n"
	
			if(D111[1]== x+y+z) {onFace[1][i]=1;nOnF[i]++}
			if(D111[2]== x+y-z) {onFace[2][i]=1;nOnF[i]++}
			if(D111[3]== x-y+z) {onFace[3][i]=1;nOnF[i]++}
			if(D111[4]== x-y-z) {onFace[4][i]=1;nOnF[i]++}
			if(D111[5]==-x+y+z) {onFace[5][i]=1;nOnF[i]++}
			if(D111[6]==-x+y-z) {onFace[6][i]=1;nOnF[i]++}
			if(D111[7]==-x-y+z) {onFace[7][i]=1;nOnF[i]++}
			if(D111[8]==-x-y-z) {onFace[8][i]=1;nOnF[i]++}
			if( D002[1]/2==x)   {onFace[9][i]=1;nOnF[i]++}
			if(-D002[2]/2==x)   {onFace[10][i]=1;nOnF[i]++}
			if( D002[3]/2==y)   {onFace[11][i]=1;nOnF[i]++}
			if(-D002[4]/2==y)   {onFace[12][i]=1;nOnF[i]++}
			if( D002[5]/2==z)   {onFace[13][i]=1;nOnF[i]++}
			if(-D002[6]/2==z)   {onFace[14][i]=1;nOnF[i]++}
			
			if(nOnF[i]>=1) cdF[++nF]=[x,y,z]
			if(nOnF[i]>=2) cdE[++nE]=[x,y,z]
			if(nOnF[i]>=3) cdV[++nV]=[x,y,z]
		}
	}
	
	cdB=[];
	
	prtCoor($("field1_opt").value,"field1")
	prtCoor($("field2_opt").value,"field2")
// 	$("field2").value=lsS
}

function prtCoor(field_opt,field){
	var n,cd;
	var ls="\nAtom    X           Y           Z\nH  "+fmtcdNum([0,0,0],12.5,a)+"\n", cen=1;
	
	if(field_opt=="Shape")  {n=nS,cd=cdS};
	if(field_opt=="Face")   {n=nF,cd=cdF};
	if(field_opt=="Edge")   {n=nE,cd=cdE};
	if(field_opt=="Vertex") {n=nV,cd=cdV};
	
	for(i=1; i<=n; i++) {
		if(cd[i][0]==0 && cd[i][1]==0 && cd[i][2]==0) cen=0;
		else ls += "Al "+fmtcdNum(cd[i],12.5,a)+"\n";
	}
	ls=(n+cen)+ls;
	
	$(field).value=ls
}

function calArea() {
	var j0,j1,j2;
	area=0
	
	for(i=1; i<=8; i++) {
		j0=0, j1=0, j2=0
		for(j=1; j<=nE; j++) {
			if(D111_f[i,j]==1) {
				if(j0==0) j0=j
				else if(j1==0) j1=j
				else {
					j2=j
					
				}
			}
		}
	}
		
}

function sortVrt(ii,N,cd) {
	var l0=calLen(ii,ii+1), l1
	for(i=ii+2; i<=N; i++) {
		l1=calLen(ii,i)
		if(l1<l0) l0=l1
	}
}

function calTriArea(i1,i2,i3,cd) {
	var l1=calLen(i1,i2,cd), l2=calLen(i1,i3,cd), l3=calLen(i3,i2,cd)
	var s=(l1+l2+l3)/2
	return Math.sqrt(s*(s-s1)*(s-s2)*(s-s3))
}

function calLen(i1,i2,cd) {
	var lx=pow(Math.abs(cd[i1][0]-cd[i2][0]),2)
	var ly=pow(Math.abs(cd[i1][1]-cd[i2][1]),2)
	var lz=pow(Math.abs(cd[i1][2]-cd[i2][2]),2)
	return Math.sqrt(lx+ly+lz)
}

function loadMol(field,Canv) {
	var ls=$(field).value
	Canv.loadMolecule(ChemDoodle.readXYZ(ls));
	Canv.specs.compass_display = true;
}

function genNow() {
	genCoor(); loadMol("field1",Canv1); loadMol("field2",Canv2)
}

function fmtNum(num, fmt) {
	var fmt=String(fmt), m=fmt.split(".")[0]
	num=num.toFixed(fmt.split(".")[1])
	if(num.length<m) num=Array(m-num.length+1).join(" ")+num
	return num
}

function fmtcdNum(num, fmt, a) {
	var fmt=String(fmt), m=fmt.split(".")[0], fmtnum=[]
	for(var i=0; i<3; i++) {
		fmtnum[i]=(num[i]*a).toFixed(fmt.split(".")[1])
		if(fmtnum[i].length<m) fmtnum[i]=Array(m-fmtnum[i].length+1).join(" ")+fmtnum[i]
	}
	return fmtnum
}

function fmtStr(str, fmt) {
	if(str.length<fmt) str += Array(fmt-str.length+1).join(" ")
	return str
}

</script>


</body>
</html>


